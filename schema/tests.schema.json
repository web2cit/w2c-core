{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://gitlab.wikimedia.org/diegodlh/w2c-core/-/blob/main/tests.schema.json",
  "title": "Domain translation tests configuration for Web2Cit",
  "description": "Each translation test defines translation output goals for a specific test webpage (see https://meta.wikimedia.org/wiki/Web2Cit/Early_adopters#tests.json)",
  "type": "array",
  "items": {
    "title": "Translation test",
    "type": "object",
    "properties": {
      "path": {
        "title": "Path",
        "description": "Path of the webpage used as translation test.",
        "options": { "infoText": "Do not include the hostname; just the path beginning with \"/\". You may also include query (?) and fragment (#) components. Duplicate translation tests for the same path will be ignored." },
        "type": "string"
      },
      "fields": {
        "title": "Fields",
        "description": "Each test field specifies a translation output goal for a specific citation field (see https://meta.wikimedia.org/wiki/Web2Cit/Early_adopters#Translation_field_types)",
        "options": { "infoText": "Duplicate test fields with the same field name will be ignored." },
        "type": "array",
        "items": {
          "title": "Test field",
          "oneOf": [
            {
              "title": "Item type field",
              "description": "Type of the cited resource",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["itemType"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "One of the Citoid/Zotero supported types",
                    "enum": [
                      "artwork",
                      "attachment",
                      "audioRecording",
                      "bill",
                      "blogPost",
                      "book",
                      "bookSection",
                      "case",
                      "computerProgram",
                      "conferencePaper",
                      "dictionaryEntry",
                      "document",
                      "email",
                      "encyclopediaArticle",
                      "film",
                      "forumPost",
                      "hearing",
                      "instantMessage",
                      "interview",
                      "journalArticle",
                      "letter",
                      "magazineArticle",
                      "manuscript",
                      "map",
                      "newspaperArticle",
                      "note",
                      "patent",
                      "podcast",
                      "presentation",
                      "radioBroadcast",
                      "report",
                      "statute",
                      "thesis",
                      "tvBroadcast",
                      "videoRecording",
                      "webpage"
                    ]
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Title field",
              "description": "Title of the cited resource",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["title"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A non-empty string",
                    "pattern": "^.+$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Author last names field",
              "description": "Authors' last or full names",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["authorLast"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A non-empty string",
                    "pattern": "^.+$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Author first names field",
              "description": "Authors' first names",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["authorFirst"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "An empty or non-empty string",
                    "pattern": "^.*$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Date field",
              "description": "Publishing date",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["date"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A date matching yyyy-mm-dd, yyyy-mm or yyyy formats",
                    "pattern": "^\\d{4}(-\\d{2}(-\\d{2})?)?$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Published in field",
              "description": "Work containing the cited resource",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["publishedIn"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A non-empty string",
                    "pattern": "^.+$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Published by field",
              "description": "Publisher of the cited resource",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["publishedBy"],
                  "options": { "hidden": true }
                },
                "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A non-empty string",
                    "pattern": "^.+$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            },
            {
              "title": "Language field",
              "description": "Publishing language",
              "type": "object",
              "properties": {
                "fieldname": {
                  "title": "Field name",
                  "type": "string",
                  "enum": ["language"],
                  "options": { "hidden": true }
                },
                 "goal": {
                  "$ref": "#/definitions/goal",
                  "maxItems": 1,
                  "items": {
                    "$ref": "#/definitions/value",
                    "description": "A language code matching xx or xx-xx* formats",
                    "pattern": "^[a-zA-Z]{2}(?:-?[a-zA-Z]{2,})*$"
                  }
                }
              },
              "required": [
                "fieldname",
                "goal"
              ]
            }
          ]
        }
      }
    },
    "required": [
      "path",
      "fields"
    ]
  },
  "definitions": {
    "goal": {
      "title": "Translation goal",
      "description": "A list of values representing the expected translation output for a test field.",
      "options": { "infoText": "Provide an empty list to explicitly express that no output is expected." },
      "type": "array"
    },
    "value": {
      "title": "Output value",
      "type": "string"
    }
  }
}
